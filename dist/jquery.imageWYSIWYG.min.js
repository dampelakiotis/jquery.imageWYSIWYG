/*! jQuery Imagewysiwyg - v0.1.0 - 2012-11-11
* https://github.com/nickromano/jquery.imageWYSIWYG
* Copyright (c) 2012 Nick Romano; Licensed GPL */
(function(a){"use strict";var b={init:function(b,c){this.$el=a(b),this.$te=this.$el.prev(),this.config=a.extend({},a.fn.imageWYSIWYG.defaults,c),this.setUpContainer()},setUpContainer:function(){this.images=a("<ul>"),this.container=a("<div>",{"class":"images-wysiwyg-container"}).html(this.images);var b=this;a.each(this.config.images,function(){b.addImage(this)}),this.$te.before(this.container),this.addButton()},addImage:function(b){var c=a("<img>",{src:b.src,alt:b.description}),d=a("<p>",{text:b.description}),e=this,f=a("<a>",{"class":"images-wysiwyg-image",href:"#"}).append(c).append(d).click(function(a){a.preventDefault(),e.openImage(this)}),g=a("<li>",{"class":"item"}).append(f);this.images.append(g)},addButton:function(){var b=this;this.addImageButton=a("<button>",{text:"Add Image","class":"images-wysiwyg-button",click:function(a){a.preventDefault(),b.openPicker()}}),this.$te.before(this.addImageButton)},openPicker:function(){this.container.css("display")==="block"?(this.container.css("display","none"),this.addImageButton.text("Add Image")):(this.container.css("display","block"),this.addImageButton.text("Close"))},openImage:function(a){this.createOverlay(),this.loadViewer(a,this.modal)},createOverlay:function(){this.overlay=a("<div>",{"class":"images-wysiwyg-overlay"}),this.modal=a("<div>",{"class":"images-wysiwyg-modal"});var b=this;a("body").append(this.overlay).append(this.modal).css({"overflow-y":"hidden"}),this.overlay.animate({opacity:"0.6"},200,"linear").click(function(){b.closeOverlay()})},closeOverlay:function(){var b=this;a(this.overlay,this.modal).animate({opacity:"0"},200,"linear",function(){b.overlay.remove(),b.modal.remove()})},loadViewer:function(b,c){var d=a(b).find("img").attr("src");c.html('<img src="'+d+'" alt="" />');var e=c.find("img"),f=this;e.load(function(){var b=e.width(),d=e.height(),g=a(window),h=e.width()/e.height(),i=g.height(),j=Math.round(i/2*h),k=i/2;e.css({width:j,height:k}),c.css({top:i/2-k/2,left:g.width()/2-j/2}).animate({opacity:"1"},200,"linear"),f.addSizeSelector(c,e,d,k,h)})},addSizeSelector:function(b,c,d,e,f){e>d&&(d=e);var g=e/d,h=a("<input>",{type:"range",min:"0",max:d}).on("change",function(){var b=a(this).attr("value");c.css({height:b,width:b*f})}),i=a("<p>",{text:"Size: "}).css({margin:"0",background:"white"}).append(h);h.attr("value",e),c.before(i),this.addInsertButton(i,c)},addInsertButton:function(b,c){var d=this,e=a("<button>",{text:"Insert","class":"images-wysiwyg-button",click:function(b){b.preventDefault();var e=a("<img>",{src:c.attr("src"),height:c.css("height"),width:c.css("width")});d.$te.find(".jqte_Content").append(e),d.closeOverlay()}});b.append(e)}};a.fn.imageWYSIWYG=function(a){var c=Object.create(b);return this.each(function(){c.init(this,a)})},a.fn.imageWYSIWYG.defaults={images:[]}})(jQuery);